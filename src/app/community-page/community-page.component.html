<div class="container-fluid" *ngVar="(communityRD$ | async) as communityRD">
  <div class="row">
    <div class="col-lg-12">
      <ul ngbNav #nav="ngbNav" class="nav-tabs" style="margin-bottom: 0px!important;">
        <li ngbNavItem>
          <a ngbNavLink class="h5">
            <i class="fas fa-inbox me-2 fa-lg"></i>
            <span>{{'home.browse.repository' | translate}}</span>
          </a>
          <ng-template ngbNavContent>
            @if (communityRD?.hasSucceeded) {
            <div class="community-page" @fadeInOut>
              @if (communityRD?.payload; as communityPayload) {
              <div>
                <section class="row border-bottom mb-4 pt-2">
                  <div class="col-12 col-sm-3">
                    <!-- Community logo -->
                    <ds-comcol-page-logo *ngIf="logoRD$" [logo]="(logoRD$ | async)?.payload"
                      [alternateText]="'Community Logo'">
                    </ds-comcol-page-logo>
                  </div>
                  <div class="col-12 d-flex col-sm-9 ps-md-0">
                    <header class="comcol-header mr-auto">
                      <!-- Community name -->
                      <ds-comcol-page-header [name]="dsoNameService.getName(communityPayload)"></ds-comcol-page-header>
                      <!-- Handle -->
                      <ds-comcol-page-handle [content]="communityPayload.handle" [title]="'community.page.handle'">
                      </ds-comcol-page-handle>
                      <!-- Introductory text -->
                      <ds-comcol-page-content [content]="communityPayload.introductoryText" [hasInnerHtml]="true">
                      </ds-comcol-page-content>
                      <!-- News -->
                      <ds-comcol-page-content [content]="communityPayload.sidebarText" [hasInnerHtml]="true"
                        [title]="'community.page.news'">
                      </ds-comcol-page-content>
                    </header>
                    <ds-dso-edit-menu></ds-dso-edit-menu>
                  </div>
                </section>
                <section class="comcol-page-browse-section">
                  <!-- Browse-By Links -->
                  <ds-comcol-page-browse-by [id]="communityPayload.id" [contentType]="communityPayload.type">
                  </ds-comcol-page-browse-by>
                  <router-outlet></router-outlet>
                </section>
                @if (communityPayload.copyrightText) {
                <footer class="border-top my-5 pt-4">
                  <!-- Copyright -->
                  <ds-comcol-page-content [content]="communityPayload.copyrightText" [hasInnerHtml]="true">
                  </ds-comcol-page-content>
                </footer>
                }
              </div>
              }
            </div>
            }
          </ng-template>
        </li>
        <li ngbNavItem>
          <a ngbNavLink class="h5"><i class="fas fa-chart-line me-2 fa-lg"></i>{{'home.whats.trending' | translate}}</a>
          <ng-template ngbNavContent>

            <div class="chart-tabs" style="margin-top: 10px;">
              <ul ngbNav #nav="ngbNav" class="nav-tabs" style="margin-bottom: 0px!important;">
                <li ngbNavItem>
                  <a ngbNavLink><i class="fas fa-chart-line me-2"></i>{{'community.trending.items' | translate}}</a>
                  <ng-template ngbNavContent>
                    @let communityId = communityId$ | async;
                    @if (communityId) {
                    <ng-container>
                      <ds-home-trending-item [collectionorCommunityId]="communityId"
                        type="community"></ds-home-trending-item>
                    </ng-container>
                    }
                  </ng-template>
                </li>
                <li ngbNavItem>
                  <a ngbNavLink><i class="fas fa-chart-pie me-2"></i>{{'community.trending.metrics' | translate}}</a>
                  <ng-template ngbNavContent>
                    <div class="trending-metrics">
                      @let communityId = communityId$ | async;
                      <div class="row align-items-center" style="margin-left: 0px;margin-right: 0px;">
                        @if (communityId) {
                        <ng-container>
                          <ds-home-tranding-geolocation [collectionorCommunityId]="communityId"
                            type="community"></ds-home-tranding-geolocation>
                        </ng-container>
                        }
                      </div>
                      <hr>
                      <div class="column-chart">
                        @if (communityId) {
                        <ng-container>
                          <ds-home-tranding-types [collectionorCommunityId]="communityId"
                            type="community"></ds-home-tranding-types>
                        </ng-container>
                        }
                      </div>
                      <hr>
                      <div class="column-chart">
                        @if (communityId) {
                        <ng-container>
                          <ds-home-tranding-collections [collectionorCommunityId]="communityId"
                            type="community"></ds-home-tranding-collections>
                        </ng-container>
                        }
                      </div>
                    </div>
                  </ng-template>
                </li>
              </ul>
              <div [ngbNavOutlet]="nav" class="bg-white"></div>
            </div>

          </ng-template>
        </li>
      </ul>
      <div [ngbNavOutlet]="nav"></div>
    </div>
  </div>
  @if (communityRD?.hasFailed) {
  <ds-error message="{{'error.community' | translate}}"></ds-error>
  }
  @if (communityRD?.isLoading) {
  <ds-loading message="{{'loading.community' | translate}}"></ds-loading>
  }
</div>